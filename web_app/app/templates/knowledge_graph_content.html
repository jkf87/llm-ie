<!-- Knowledge Graph Content Template -->
<div class="knowledge-graph-container">
    <!-- íŒŒì¼ ì—…ë¡œë“œ ì„¹ì…˜ -->
    <div class="upload-section">
        <h3>ğŸ“Š ì§€ì‹ê·¸ë˜í”„ ìƒì„±</h3>
        <div class="file-upload-area">
            <div class="upload-zone" id="kg-upload-zone">
                <div class="upload-icon">ğŸ“</div>
                <p>LLM-IE ì¶”ì¶œ ê²°ê³¼ íŒŒì¼ (.llmie)ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                <input type="file" id="kg-file-input" accept=".llmie" style="display: none;">
                <button type="button" class="btn btn-primary" onclick="document.getElementById('kg-file-input').click()">
                    íŒŒì¼ ì„ íƒ
                </button>
            </div>
            <div class="file-info" id="kg-file-info" style="display: none;">
                <p><strong>ì„ íƒëœ íŒŒì¼:</strong> <span id="kg-file-name"></span></p>
                <p><strong>íŒŒì¼ í¬ê¸°:</strong> <span id="kg-file-size"></span></p>
            </div>
        </div>
    </div>

    <!-- ì„¤ì • ì„¹ì…˜ -->
    <div class="settings-section">
        <h4>ğŸ”§ ì§€ì‹ê·¸ë˜í”„ ì„¤ì •</h4>
        <div class="settings-grid">
            <div class="setting-item">
                <label for="kg-enable-llm-inference">
                    <input type="checkbox" id="kg-enable-llm-inference" checked>
                    ê³ ê¸‰ ê´€ê³„ ì¶”ë¡  í™œì„±í™”
                </label>
                <small>Multi-Agent ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ë°˜ë³µì ìœ¼ë¡œ ê´€ê³„ë¥¼ ê°œì„ í•©ë‹ˆë‹¤</small>
            </div>
            <div class="setting-item">
                <label for="kg-llm-api-select">LLM API ì„ íƒ:</label>
                <select id="kg-llm-api-select">
                    <option value="gemini_direct">Gemini Direct API (ì¶”ì²œ)</option>
                    <option value="openai_compatible">OpenAI Compatible</option>
                    <option value="ollama">Ollama</option>
                </select>
            </div>
            <div class="setting-item" id="kg-gemini-settings">
                <label for="kg-gemini-api-key">Gemini API Key:</label>
                <input type="password" id="kg-gemini-api-key" placeholder="AIzaSy..." class="form-control">
            </div>
        </div>
    </div>

    <!-- ê´€ê³„ ì¶”ë¡  ì»¨í…ìŠ¤íŠ¸ ì„¹ì…˜ -->
    <div class="context-section" id="kg-context-section" style="display: none;">
        <h4>ğŸ¯ ê´€ê³„ ì¶”ë¡  ì»¨í…ìŠ¤íŠ¸</h4>
        <div class="context-grid">
            <div class="context-item">
                <label for="kg-domain-select">ë¬¸ì„œ ë„ë©”ì¸:</label>
                <select id="kg-domain-select" class="form-control">
                    <option value="research_paper">ğŸ“š ì—°êµ¬ ë…¼ë¬¸</option>
                    <option value="technical_document">ğŸ”§ ê¸°ìˆ  ë¬¸ì„œ</option>
                    <option value="business_document">ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œ</option>
                    <option value="general">ğŸ“„ ì¼ë°˜ ë¬¸ì„œ</option>
                </select>
                <small>ë„ë©”ì¸ì— ë”°ë¼ ì ì ˆí•œ ê´€ê³„ ìœ í˜•ì´ ì¶”ì²œë©ë‹ˆë‹¤</small>
            </div>
            <div class="context-item full-width">
                <label for="kg-user-context">ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸:</label>
                <textarea id="kg-user-context" class="form-control" rows="3" 
                    placeholder="ë¬¸ì„œì˜ ì£¼ì œ, ëª©ì , íŠ¹ë³„í•œ ë§¥ë½ ë“±ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”. ì˜ˆ: 'ì´ ë…¼ë¬¸ì€ LLM ì„±ê²© ë¶„ì„ì— ê´€í•œ ì—°êµ¬ë¡œ, ì—¬ëŸ¬ ëª¨ë¸ë“¤ì„ IPIP-NEO-120 ì„¤ë¬¸ì§€ë¡œ ë¹„êµ í‰ê°€í•©ë‹ˆë‹¤.'"></textarea>
                <small>ì´ ì •ë³´ëŠ” ë” ì •í™•í•œ ê´€ê³„ ì¶”ë¡ ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤</small>
            </div>
            <div class="context-item full-width">
                <label for="kg-additional-guidelines">ì¶”ê°€ ê°€ì´ë“œë¼ì¸:</label>
                <textarea id="kg-additional-guidelines" class="form-control" rows="2"
                    placeholder="íŠ¹ì • ê´€ê³„ ìœ í˜•ì„ ê°•ì¡°í•˜ê±°ë‚˜ ì œì™¸í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: 'MODEL ì—”í‹°í‹°ë“¤ ê°„ì—ëŠ” COMPARES_WITH ê´€ê³„ë¥¼ ìš°ì„  ì°¾ì•„ì£¼ì„¸ìš”.'"></textarea>
                <small>ì„ íƒì‚¬í•­: íŠ¹ë³„í•œ ê´€ê³„ ì¶”ë¡  ê·œì¹™ì´ë‚˜ ì„ í˜¸ë„</small>
            </div>
        </div>
    </div>

    <!-- ê´€ê³„ ì¶”ë¡  ì„¤ì • -->
    <div class="inference-settings-section" id="kg-inference-settings" style="display: none;">
        <h4>âš™ï¸ ì¶”ë¡  ë§¤ê°œë³€ìˆ˜</h4>
        <div class="inference-grid">
            <div class="inference-item">
                <label for="kg-max-relations">ìµœëŒ€ ê´€ê³„ ìˆ˜:</label>
                <input type="number" id="kg-max-relations" value="20" min="5" max="50" class="form-control">
                <small>ì¶”ë¡ í•  ìµœëŒ€ ê´€ê³„ ê°œìˆ˜</small>
            </div>
            <div class="inference-item">
                <label for="kg-target-score">ëª©í‘œ í’ˆì§ˆ ì ìˆ˜:</label>
                <input type="number" id="kg-target-score" value="75" min="50" max="95" step="5" class="form-control">
                <small>ì´ ì ìˆ˜ì— ë„ë‹¬í•˜ë©´ ë°˜ë³µ ì¢…ë£Œ (100ì  ë§Œì )</small>
            </div>
            <div class="inference-item">
                <label for="kg-max-iterations">ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜:</label>
                <input type="number" id="kg-max-iterations" value="3" min="1" max="5" class="form-control">
                <small>ê´€ê³„ í’ˆì§ˆ ê°œì„ ì„ ìœ„í•œ ìµœëŒ€ ì‹œë„ íšŸìˆ˜</small>
            </div>
            <div class="inference-item">
                <label for="kg-enable-relation-review">
                    <input type="checkbox" id="kg-enable-relation-review">
                    ê´€ê³„ ê²€í†  ë‹¨ê³„ í¬í•¨
                </label>
                <small>ìƒì„±ëœ ê´€ê³„ë¥¼ ì‚¬ìš©ìê°€ ê²€í† í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</small>
            </div>
        </div>
    </div>

    <!-- ì•¡ì…˜ ë²„íŠ¼ -->
    <div class="action-buttons">
        <button type="button" id="generate-kg-btn" class="btn btn-success" disabled>
            ğŸš€ ì§€ì‹ê·¸ë˜í”„ ìƒì„±
        </button>
        <button type="button" id="validate-kg-btn" class="btn btn-info" disabled>
            ğŸ” ì§€ì‹ê·¸ë˜í”„ ê²€ì¦
        </button>
        <button type="button" id="clear-kg-btn" class="btn btn-secondary">
            ğŸ—‘ï¸ ê²°ê³¼ ì§€ìš°ê¸°
        </button>
    </div>

    <!-- ì§„í–‰ìƒí™© í‘œì‹œ -->
    <div class="progress-section" id="kg-progress" style="display: none;">
        <h4>ì§„í–‰ ìƒí™©</h4>
        <div class="progress-bar">
            <div class="progress-fill" id="kg-progress-fill"></div>
        </div>
        <div class="progress-text" id="kg-progress-text">ì¤€ë¹„ ì¤‘...</div>
    </div>

    <!-- ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ -->
    <div class="results-section" id="kg-results" style="display: none;">
        <h3>ğŸ“ˆ ì§€ì‹ê·¸ë˜í”„ ê²°ê³¼</h3>
        
        <!-- í†µê³„ ì •ë³´ -->
        <div class="stats-panel" id="kg-stats">
            <h4>ğŸ“Š í†µê³„</h4>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">ì´ íŠ¸ë¦¬í”Œ:</span>
                    <span class="stat-value" id="total-triples">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ì—”í‹°í‹°:</span>
                    <span class="stat-value" id="total-entities">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ê´€ê³„:</span>
                    <span class="stat-value" id="total-relations">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ë¬¸ì„œ:</span>
                    <span class="stat-value" id="total-documents">0</span>
                </div>
            </div>
        </div>

        <!-- ì‹œê°í™” -->
        <div class="visualization-panel">
            <h4>ğŸ•¸ï¸ ì§€ì‹ê·¸ë˜í”„ ì‹œê°í™”</h4>
            <div class="viz-controls">
                <button type="button" class="btn btn-sm btn-outline-primary" id="fit-network">
                    ì „ì²´ ë³´ê¸°
                </button>
                <button type="button" class="btn btn-sm btn-outline-secondary" id="toggle-physics">
                    ë¬¼ë¦¬ íš¨ê³¼ í† ê¸€
                </button>
            </div>
            <div id="kg-visualization" class="network-container"></div>
        </div>

        <!-- RDF ì¶œë ¥ -->
        <div class="rdf-panel">
            <h4>ğŸ“„ RDF ì¶œë ¥</h4>
            <div class="rdf-format-tabs">
                <button type="button" class="tab-btn active" data-format="turtle">Turtle</button>
                <button type="button" class="tab-btn" data-format="xml">RDF/XML</button>
                <button type="button" class="tab-btn" data-format="json-ld">JSON-LD</button>
                <button type="button" class="tab-btn" data-format="n3">N3</button>
            </div>
            <div class="rdf-content">
                <pre id="rdf-output" class="rdf-code"></pre>
            </div>
            <div class="rdf-actions">
                <button type="button" class="btn btn-primary" id="copy-rdf-btn">
                    ğŸ“‹ ë³µì‚¬
                </button>
                <button type="button" class="btn btn-success" id="download-rdf-btn">
                    ğŸ’¾ ë‹¤ìš´ë¡œë“œ
                </button>
            </div>
        </div>
    </div>

    <!-- ê²€ì¦ ê²°ê³¼ ì„¹ì…˜ -->
    <div class="validation-section" id="kg-validation-results" style="display: none;">
        <h3>ğŸ” ì§€ì‹ê·¸ë˜í”„ ê²€ì¦ ê²°ê³¼</h3>
        
        <!-- ì „ì²´ ì ìˆ˜ -->
        <div class="validation-score">
            <div class="score-circle">
                <span class="score-value" id="validation-score">0</span>
                <span class="score-label">/100</span>
            </div>
            <div class="score-info">
                <p><strong>ì „ì²´ ê²€ì¦ ì ìˆ˜</strong></p>
                <p id="validation-summary">ê²€ì¦ ì§„í–‰ ì¤‘...</p>
            </div>
        </div>

        <!-- ê²€ì¦ ì„¸ë¶€ì‚¬í•­ -->
        <div class="validation-details">
            <h4>ì„¸ë¶€ ê²€ì¦ ê²°ê³¼</h4>
            <div id="validation-checks"></div>
        </div>

        <!-- LLM ê²€ì¦ ê²°ê³¼ -->
        <div class="llm-validation" id="llm-validation-panel" style="display: none;">
            <h4>ğŸ¤– LLM í’ˆì§ˆ í‰ê°€</h4>
            <div class="llm-scores" id="llm-scores"></div>
            <div class="llm-feedback">
                <div class="feedback-section">
                    <h5>âœ… ê°•ì </h5>
                    <ul id="validation-strengths"></ul>
                </div>
                <div class="feedback-section">
                    <h5>âš ï¸ ì•½ì </h5>
                    <ul id="validation-weaknesses"></ul>
                </div>
                <div class="feedback-section">
                    <h5>ğŸ’¡ ì¶”ì²œì‚¬í•­</h5>
                    <ul id="validation-recommendations"></ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ê´€ê³„ í¸ì§‘ ëª¨ë‹¬ í¬í•¨ -->
{% include 'relation_editor_modal.html' %}

<!-- ìŠ¤íƒ€ì¼ ì •ì˜ -->
<style>
.knowledge-graph-container {
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.upload-section, .settings-section, .results-section, .validation-section {
    background: #f8f9fa;
    padding: 20px;
    margin: 20px 0;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.upload-zone {
    border: 2px dashed #007bff;
    border-radius: 8px;
    padding: 40px 20px;
    text-align: center;
    background: #f8f9ff;
    transition: all 0.3s ease;
}

.upload-zone:hover {
    border-color: #0056b3;
    background: #e6f2ff;
}

.upload-zone.drag-over {
    border-color: #28a745;
    background: #e6ffe6;
}

.upload-icon {
    font-size: 48px;
    margin-bottom: 16px;
}

.settings-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 15px;
}

.setting-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.setting-item label {
    font-weight: 500;
}

.setting-item small {
    color: #6c757d;
    font-size: 0.875em;
}

.action-buttons {
    display: flex;
    gap: 12px;
    margin: 20px 0;
}

.progress-section {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.progress-bar {
    width: 100%;
    height: 24px;
    background: #e9ecef;
    border-radius: 12px;
    overflow: hidden;
    margin: 10px 0;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #007bff, #0056b3);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-text {
    text-align: center;
    font-weight: 500;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 16px;
    margin-top: 15px;
}

.stat-item {
    background: white;
    padding: 16px;
    border-radius: 8px;
    text-align: center;
    border: 1px solid #dee2e6;
}

.stat-label {
    display: block;
    font-size: 0.875em;
    color: #6c757d;
    margin-bottom: 8px;
}

.stat-value {
    display: block;
    font-size: 2em;
    font-weight: bold;
    color: #007bff;
}

.visualization-panel, .rdf-panel {
    background: white;
    padding: 20px;
    margin: 20px 0;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.viz-controls {
    margin-bottom: 16px;
}

.network-container {
    width: 100%;
    height: 500px;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    background: #fafafa;
}

.rdf-format-tabs {
    display: flex;
    gap: 2px;
    margin-bottom: 16px;
}

.tab-btn {
    background: #e9ecef;
    border: none;
    padding: 8px 16px;
    cursor: pointer;
    border-radius: 4px 4px 0 0;
    transition: background 0.2s;
}

.tab-btn.active {
    background: #007bff;
    color: white;
}

.tab-btn:hover:not(.active) {
    background: #dee2e6;
}

.rdf-content {
    max-height: 400px;
    overflow: auto;
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 4px;
}

.rdf-code {
    margin: 0;
    padding: 16px;
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
    font-size: 0.875em;
    line-height: 1.4;
    background: none;
    border: none;
}

.rdf-actions {
    margin-top: 12px;
    display: flex;
    gap: 8px;
}

.validation-score {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
}

.score-circle {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    font-weight: bold;
}

.score-value {
    font-size: 2.5em;
    line-height: 1;
}

.score-label {
    font-size: 1em;
    opacity: 0.8;
}

.score-info {
    flex: 1;
}

.validation-checks {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.validation-check {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: white;
    border-radius: 6px;
    border: 1px solid #dee2e6;
}

.validation-check.passed {
    border-color: #28a745;
    background: #f8fff9;
}

.validation-check.failed {
    border-color: #dc3545;
    background: #fff8f8;
}

.check-icon {
    font-size: 1.5em;
}

.check-icon.passed {
    color: #28a745;
}

.check-icon.failed {
    color: #dc3545;
}

.llm-scores {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 20px;
}

.llm-score-item {
    background: white;
    padding: 16px;
    border-radius: 8px;
    text-align: center;
    border: 1px solid #dee2e6;
}

.feedback-section {
    margin-bottom: 20px;
}

.feedback-section h5 {
    margin-bottom: 10px;
    font-weight: 600;
}

.feedback-section ul {
    list-style-type: none;
    padding-left: 0;
}

.feedback-section li {
    background: white;
    padding: 8px 12px;
    margin-bottom: 8px;
    border-radius: 4px;
    border-left: 4px solid #007bff;
}

@media (max-width: 768px) {
    .settings-grid {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .validation-score {
        flex-direction: column;
        text-align: center;
    }
}
</style>